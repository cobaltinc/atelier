(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{317:function(module,exports,__webpack_require__){__webpack_require__(318),__webpack_require__(477),__webpack_require__(478),module.exports=__webpack_require__(628)},385:function(module,exports){},478:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(247)},628:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(247).configure)([__webpack_require__(629)],module,!1)}).call(this,__webpack_require__(193)(module))},629:function(module,exports,__webpack_require__){var map={"./index.stories.tsx":644};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=629},644:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return index_stories_Default})),__webpack_require__.d(__webpack_exports__,"CustomPlugin",(function(){return index_stories_CustomPlugin})),__webpack_require__.d(__webpack_exports__,"Recording",(function(){return index_stories_Recording}));__webpack_require__(630),__webpack_require__(16),__webpack_require__(14),__webpack_require__(35),__webpack_require__(632),__webpack_require__(633),__webpack_require__(634),__webpack_require__(55),__webpack_require__(635),__webpack_require__(307),__webpack_require__(22),__webpack_require__(27),__webpack_require__(17),__webpack_require__(30),__webpack_require__(24),__webpack_require__(23),__webpack_require__(28),__webpack_require__(31),__webpack_require__(45),__webpack_require__(87),__webpack_require__(66),__webpack_require__(73),__webpack_require__(88),__webpack_require__(89),__webpack_require__(90),__webpack_require__(74);var react=__webpack_require__(0);function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Plugin=function(){function Plugin(initialValues){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Plugin),this.name=void 0,this.canvas=void 0,this.name="",Object.assign(this,initialValues)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(Plugin,[{key:"draw",value:function draw(data){var _this$canvas,context=null===(_this$canvas=this.canvas)||void 0===_this$canvas?void 0:_this$canvas.getContext("2d");context&&Object.assign(context,{globalCompositeOperation:"source-over",strokeStyle:data.color,lineCap:"round",lineJoin:"round",shadowColor:"",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,lineWidth:data.lineWidth,textAlign:"left",textBaseline:"top",direction:"ltr",lineDashOffset:0,miterLimit:0,globalAlpha:1,fillStyle:data.color})}}]),Plugin}();function pen_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function pen_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},_get(target,property,receiver||target)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var PenPlugin=function(_Plugin){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(PenPlugin,_Plugin);var _super=_createSuper(PenPlugin);function PenPlugin(){var _this;pen_classCallCheck(this,PenPlugin);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="pen",_this.coord={x:0,y:0,oldX:0,oldY:0},_this.midCoord={x:0,y:0,oldX:0,oldY:0},_this}return function pen_createClass(Constructor,protoProps,staticProps){return protoProps&&pen_defineProperties(Constructor.prototype,protoProps),staticProps&&pen_defineProperties(Constructor,staticProps),Constructor}(PenPlugin,[{key:"draw",value:function draw(data){var _this$canvas;_get(_getPrototypeOf(PenPlugin.prototype),"draw",this).call(this,data);var x=data.x,y=data.y,state=data.state,context=null===(_this$canvas=this.canvas)||void 0===_this$canvas?void 0:_this$canvas.getContext("2d");context&&(this.coord.x=x,this.coord.y=y,this.coord.oldX=this.coord.oldX||x,this.coord.oldY=this.coord.oldY||y,this.midCoord.x=this.coord.oldX+this.coord.x>>1,this.midCoord.y=this.coord.oldY+this.coord.y>>1,this.midCoord.oldX=this.midCoord.oldX||x,this.midCoord.oldY=this.midCoord.oldY||y,"draw-started"===state||"drawing"===state?(context.beginPath(),context.moveTo(this.midCoord.x,this.midCoord.y),context.quadraticCurveTo(this.coord.oldX,this.coord.oldY,this.midCoord.oldX,this.midCoord.oldY),context.stroke(),context.closePath(),this.coord.oldX=this.coord.x,this.coord.oldY=this.coord.y,this.midCoord.oldX=this.midCoord.x,this.midCoord.oldY=this.midCoord.y):"draw-finished"===state&&(this.coord={x:0,y:0,oldX:0,oldY:0},this.midCoord={x:0,y:0,oldX:0,oldY:0}))}}]),PenPlugin}(Plugin);function eraser_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function eraser_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function eraser_get(target,property,receiver){return eraser_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function eraser_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=eraser_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},eraser_get(target,property,receiver||target)}function eraser_setPrototypeOf(o,p){return eraser_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},eraser_setPrototypeOf(o,p)}function eraser_createSuper(Derived){var hasNativeReflectConstruct=function eraser_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=eraser_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=eraser_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return eraser_possibleConstructorReturn(this,result)}}function eraser_possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function eraser_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function eraser_getPrototypeOf(o){return eraser_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},eraser_getPrototypeOf(o)}var EraserPlugin=function(_Plugin){!function eraser_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&eraser_setPrototypeOf(subClass,superClass)}(EraserPlugin,_Plugin);var _super=eraser_createSuper(EraserPlugin);function EraserPlugin(){var _this;eraser_classCallCheck(this,EraserPlugin);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="eraser",_this.prevX=void 0,_this.prevY=void 0,_this}return function eraser_createClass(Constructor,protoProps,staticProps){return protoProps&&eraser_defineProperties(Constructor.prototype,protoProps),staticProps&&eraser_defineProperties(Constructor,staticProps),Constructor}(EraserPlugin,[{key:"draw",value:function draw(data){var _this$canvas;eraser_get(eraser_getPrototypeOf(EraserPlugin.prototype),"draw",this).call(this,data);var x=data.x,y=data.y,state=data.state,context=null===(_this$canvas=this.canvas)||void 0===_this$canvas?void 0:_this$canvas.getContext("2d");if(context){context.globalCompositeOperation="destination-out";var prevX=this.prevX||x,prevY=this.prevY||y;"draw-started"===state||"drawing"===state?(context.beginPath(),context.moveTo(prevX,prevY),context.lineTo(x,y),context.stroke(),this.prevX=x,this.prevY=y):"draw-finished"===state&&(this.prevX=void 0,this.prevY=void 0)}}}]),EraserPlugin}(Plugin);__webpack_require__(639);function laser_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function laser_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function laser_get(target,property,receiver){return laser_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function laser_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=laser_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},laser_get(target,property,receiver||target)}function laser_setPrototypeOf(o,p){return laser_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},laser_setPrototypeOf(o,p)}function laser_createSuper(Derived){var hasNativeReflectConstruct=function laser_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=laser_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=laser_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return laser_possibleConstructorReturn(this,result)}}function laser_possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function laser_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function laser_getPrototypeOf(o){return laser_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},laser_getPrototypeOf(o)}var LaserPlugin=function(_Plugin){!function laser_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&laser_setPrototypeOf(subClass,superClass)}(LaserPlugin,_Plugin);var _super=laser_createSuper(LaserPlugin);function LaserPlugin(){var _this;laser_classCallCheck(this,LaserPlugin);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="laser",_this.snapshotImage=void 0,_this}return function laser_createClass(Constructor,protoProps,staticProps){return protoProps&&laser_defineProperties(Constructor.prototype,protoProps),staticProps&&laser_defineProperties(Constructor,staticProps),Constructor}(LaserPlugin,[{key:"draw",value:function draw(data){var _this$canvas;laser_get(laser_getPrototypeOf(LaserPlugin.prototype),"draw",this).call(this,data);var x=data.x,y=data.y,width=data.width,height=data.height,scale=data.scale,state=data.state,context=null===(_this$canvas=this.canvas)||void 0===_this$canvas?void 0:_this$canvas.getContext("2d");if(context)if(context.lineWidth=6,context.strokeStyle="#e04444",context.fillStyle="#e04444",context.shadowColor="#ff0000",context.shadowBlur=10,"draw-started"===state)this.snapshotImage=context.getImageData(0,0,width*scale,height*scale);else if("drawing"===state){if(!this.snapshotImage)return;context.clearRect(0,0,width*scale,height*scale),context.putImageData(this.snapshotImage,0,0),context.beginPath(),context.arc(x,y,6,0,2*Math.PI),context.stroke(),context.fill(),context.closePath()}else"draw-finished"===state&&(context.clearRect(0,0,width*scale,height*scale),context.putImageData(this.snapshotImage,0,0),this.snapshotImage=void 0)}}]),LaserPlugin}(Plugin);function highlighter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function highlighter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function highlighter_get(target,property,receiver){return highlighter_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function highlighter_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=highlighter_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},highlighter_get(target,property,receiver||target)}function highlighter_setPrototypeOf(o,p){return highlighter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},highlighter_setPrototypeOf(o,p)}function highlighter_createSuper(Derived){var hasNativeReflectConstruct=function highlighter_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=highlighter_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=highlighter_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return highlighter_possibleConstructorReturn(this,result)}}function highlighter_possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function highlighter_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function highlighter_getPrototypeOf(o){return highlighter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},highlighter_getPrototypeOf(o)}var HighlighterPlugin=function(_Plugin){!function highlighter_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&highlighter_setPrototypeOf(subClass,superClass)}(HighlighterPlugin,_Plugin);var _super=highlighter_createSuper(HighlighterPlugin);function HighlighterPlugin(){var _this;highlighter_classCallCheck(this,HighlighterPlugin);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="highlighter",_this.coord={x:0,y:0,oldX:0,oldY:0},_this.midCoord={x:0,y:0,oldX:0,oldY:0},_this.screenCanvas=void 0,_this.snapshotImage=void 0,_this}return function highlighter_createClass(Constructor,protoProps,staticProps){return protoProps&&highlighter_defineProperties(Constructor.prototype,protoProps),staticProps&&highlighter_defineProperties(Constructor,staticProps),Constructor}(HighlighterPlugin,[{key:"draw",value:function draw(data){var _this$canvas2;highlighter_get(highlighter_getPrototypeOf(HighlighterPlugin.prototype),"draw",this).call(this,data);var _this$canvas,_this$screenCanvas$ge,x=data.x,y=data.y,width=data.width,height=data.height,scale=data.scale,lineWidth=data.lineWidth,color=data.color,state=data.state;this.screenCanvas||(this.screenCanvas=null===(_this$canvas=this.canvas)||void 0===_this$canvas?void 0:_this$canvas.cloneNode(),this.screenCanvas.width=width*scale,this.screenCanvas.height=height*scale,null===(_this$screenCanvas$ge=this.screenCanvas.getContext("2d"))||void 0===_this$screenCanvas$ge||_this$screenCanvas$ge.scale(scale,scale));var screenContext=this.screenCanvas.getContext("2d"),originalContext=null===(_this$canvas2=this.canvas)||void 0===_this$canvas2?void 0:_this$canvas2.getContext("2d");screenContext&&originalContext&&(originalContext.globalAlpha=.5,screenContext.lineCap="square",screenContext.lineWidth=lineWidth,screenContext.strokeStyle=color,this.coord.x=x,this.coord.y=y,this.coord.oldX=this.coord.oldX||x,this.coord.oldY=this.coord.oldY||y,this.midCoord.x=this.coord.oldX+this.coord.x>>1,this.midCoord.y=this.coord.oldY+this.coord.y>>1,this.midCoord.oldX=this.midCoord.oldX||x,this.midCoord.oldY=this.midCoord.oldY||y,"draw-started"===state||"drawing"===state?("draw-started"===state&&(this.snapshotImage=originalContext.getImageData(0,0,width*scale,height*scale)),screenContext.beginPath(),screenContext.moveTo(this.midCoord.x,this.midCoord.y),screenContext.quadraticCurveTo(this.coord.oldX,this.coord.oldY,this.midCoord.oldX,this.midCoord.oldY),screenContext.stroke(),screenContext.closePath(),this.coord.oldX=this.coord.x,this.coord.oldY=this.coord.y,this.midCoord.oldX=this.midCoord.x,this.midCoord.oldY=this.midCoord.y,originalContext.clearRect(0,0,width*scale,height*scale),originalContext.putImageData(this.snapshotImage,0,0),originalContext.drawImage(this.screenCanvas,0,0,width,height)):"draw-finished"===state&&(this.coord={x:0,y:0,oldX:0,oldY:0},this.midCoord={x:0,y:0,oldX:0,oldY:0},delete this.screenCanvas,this.screenCanvas=void 0))}}]),HighlighterPlugin}(Plugin);__webpack_require__(641);function brush_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function brush_get(target,property,receiver){return brush_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function brush_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=brush_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},brush_get(target,property,receiver||target)}function brush_setPrototypeOf(o,p){return brush_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},brush_setPrototypeOf(o,p)}function brush_createSuper(Derived){var hasNativeReflectConstruct=function brush_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=brush_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=brush_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return brush_possibleConstructorReturn(this,result)}}function brush_possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function brush_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function brush_getPrototypeOf(o){return brush_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},brush_getPrototypeOf(o)}var BrushPlugin=function(_Plugin){!function brush_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&brush_setPrototypeOf(subClass,superClass)}(BrushPlugin,_Plugin);var _super=brush_createSuper(BrushPlugin);function BrushPlugin(initialValues){var _this;return function brush_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BrushPlugin),(_this=_super.call(this,initialValues)).name="brush",_this.coord={x:0,y:0,oldX:0,oldY:0},_this.midCoord={x:0,y:0,oldX:0,oldY:0},_this.oldLineWidth=0,_this.enablePressure=!0,_this.enablePressure=!(null==initialValues||!initialValues.enablePressure),_this}return function brush_createClass(Constructor,protoProps,staticProps){return protoProps&&brush_defineProperties(Constructor.prototype,protoProps),staticProps&&brush_defineProperties(Constructor,staticProps),Constructor}(BrushPlugin,[{key:"draw",value:function draw(data){var _this$canvas;brush_get(brush_getPrototypeOf(BrushPlugin.prototype),"draw",this).call(this,data);var x=data.x,y=data.y,pressure=data.pressure,lineWidth=data.lineWidth,state=data.state,context=null===(_this$canvas=this.canvas)||void 0===_this$canvas?void 0:_this$canvas.getContext("2d");context&&(this.enablePressure?context.lineWidth=pressure?Math.log2(pressure+1)*lineWidth*.2+.8*this.oldLineWidth:1:context.lineWidth=.02*lineWidth+.98*this.oldLineWidth,this.coord.x=x,this.coord.y=y,this.coord.oldX=this.coord.oldX||x,this.coord.oldY=this.coord.oldY||y,this.midCoord.x=this.coord.oldX+this.coord.x>>1,this.midCoord.y=this.coord.oldY+this.coord.y>>1,this.midCoord.oldX=this.midCoord.oldX||x,this.midCoord.oldY=this.midCoord.oldY||y,"draw-started"===state||"drawing"===state?(context.beginPath(),context.moveTo(this.midCoord.x,this.midCoord.y),context.quadraticCurveTo(this.coord.oldX,this.coord.oldY,this.midCoord.oldX,this.midCoord.oldY),context.stroke(),context.closePath(),this.coord.oldX=this.coord.x,this.coord.oldY=this.coord.y,this.midCoord.oldX=this.midCoord.x,this.midCoord.oldY=this.midCoord.y,this.oldLineWidth=context.lineWidth):"draw-finished"===state&&(this.coord={x:0,y:0,oldX:0,oldY:0},this.midCoord={x:0,y:0,oldX:0,oldY:0},this.oldLineWidth=0))}}]),BrushPlugin}(Plugin),calculateCoord=(__webpack_require__(642),__webpack_require__(56),__webpack_require__(83),function calculateCoord(e,canvas){var x=0,y=0;"touches"in e&&e.touches&&e.touches[0]?(x=e.touches[0].pageX,y=e.touches[0].pageY):"pageX"in e&&(x=e.pageX,y=e.pageY);var rect=canvas.getBoundingClientRect();return{x:x-rect.left-window.scrollX,y:y-rect.top-window.scrollY}}),calculatePressure=function calculatePressure(e){var pressure=1;return"touches"in e&&e.touches&&e.touches[0]&&(pressure="stylus"===e.touches[0].touchType?e.touches[0].force||.1:e.touches[0].force||1),pressure},jsx_runtime=__webpack_require__(2);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var Atelier=Object(react.forwardRef)((function(_ref,ref){var _ref$command=_ref.command,command=void 0===_ref$command?"pen":_ref$command,_ref$color=_ref.color,color=void 0===_ref$color?"#000000":_ref$color,_ref$lineWidth=_ref.lineWidth,lineWidth=void 0===_ref$lineWidth?2:_ref$lineWidth,_ref$width=_ref.width,width=void 0===_ref$width?800:_ref$width,_ref$height=_ref.height,height=void 0===_ref$height?600:_ref$height,_canvasWidth=_ref.canvasWidth,_canvasHeight=_ref.canvasHeight,_ref$enableDraw=_ref.enableDraw,enableDraw=void 0===_ref$enableDraw||_ref$enableDraw,_ref$enablePressure=_ref.enablePressure,enablePressure=void 0!==_ref$enablePressure&&_ref$enablePressure,_ref$plugins=_ref.plugins,plugins=void 0===_ref$plugins?[PenPlugin]:_ref$plugins,onChange=_ref.onChange,style=_ref.style,className=_ref.className,canvasRef=Object(react.useRef)(null),histories=Object(react.useRef)([]),undoList=Object(react.useRef)([]),_useState2=_slicedToArray(Object(react.useState)(Object.assign.apply(Object,[{}].concat(_toConsumableArray(plugins.map((function(pluginClass){var _ref2,plugin=new pluginClass({canvas:canvasRef.current});return(_ref2={})[plugin.name]=plugin,_ref2})))))),2),currentPlugins=_useState2[0],setCurrentPlugins=_useState2[1],scale="undefined"==typeof window?1:window.devicePixelRatio,canvasWidth=_canvasWidth||width,canvasHeight=_canvasHeight||height,canvasDefaultStyle=Object(react.useMemo)((function(){return{userSelect:"none",WebkitUserSelect:"none",touchAction:"none",msTouchAction:"none"}}),[]),canvasSizeStyle=Object(react.useMemo)((function(){return{width:width,height:height}}),[width,height]);Object(react.useEffect)((function(){var _canvasRef$current$ge;canvasRef.current&&(canvasRef.current.width=(canvasWidth||width)*scale,canvasRef.current.height=(canvasHeight||height)*scale,null===(_canvasRef$current$ge=canvasRef.current.getContext("2d"))||void 0===_canvasRef$current$ge||_canvasRef$current$ge.scale(scale,scale))}),[scale,canvasWidth,canvasHeight,width,height]),Object(react.useEffect)((function(){canvasRef.current&&setCurrentPlugins(Object.assign.apply(Object,[{}].concat(_toConsumableArray(plugins.map((function(pluginClass){var _ref3,plugin=new pluginClass({canvas:canvasRef.current});return(_ref3={})[plugin.name]=plugin,_ref3}))))))}),[JSON.stringify(plugins)]);var handleCommit=Object(react.useCallback)((function(e){if(undoList.current=[],"draw"===e.type){var data=e.data;if("draw-started"===(null==data?void 0:data.state))histories.current.push([e]);else{var length=histories.current.length;histories.current[length-1].push(e)}}else e&&histories.current.push([e])}),[histories]),handleDraw=Object(react.useCallback)((function(data){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{commit:!0,fireOnChange:!0},drawingData=Object.assign({},data,{x:data.x/data.width*canvasWidth,y:data.y/data.height*canvasHeight,width:width,height:height,lineWidth:data.lineWidth/data.width*width});currentPlugins[data.command].draw(drawingData),(null==options?void 0:options.fireOnChange)&&(null==onChange||onChange({type:"draw",data:drawingData})),(null==options?void 0:options.commit)&&handleCommit({type:"draw",data:drawingData})}),[currentPlugins,canvasWidth,canvasHeight,width,height]),handleClear=Object(react.useCallback)((function(){var _canvasRef$current,_canvasRef$current$ge2,options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{commit:!0,fireOnChange:!0};null===(_canvasRef$current=canvasRef.current)||void 0===_canvasRef$current||null===(_canvasRef$current$ge2=_canvasRef$current.getContext("2d"))||void 0===_canvasRef$current$ge2||_canvasRef$current$ge2.clearRect(0,0,canvasWidth,canvasHeight),(null==options?void 0:options.fireOnChange)&&(null==onChange||onChange({type:"clear"})),(null==options?void 0:options.commit)&&handleCommit({type:"clear"})}),[canvasWidth,canvasHeight]),handleRedo=Object(react.useCallback)((function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fireOnChange:!0};0!==undoList.current.length&&(histories.current.push(undoList.current.pop()),handleClear({commit:!1,fireOnChange:!1}),histories.current.reduce((function(prev,curr){return[].concat(_toConsumableArray(prev),_toConsumableArray(curr))}),[]).forEach((function(event){"draw"===event.type?handleDraw(event.data,{commit:!1,fireOnChange:!1}):"clear"===event.type&&handleClear({commit:!1,fireOnChange:!1})})),(null==options?void 0:options.fireOnChange)&&(null==onChange||onChange({type:"redo"})))}),[handleDraw,handleClear,onChange]),handleUndo=Object(react.useCallback)((function(){var options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fireOnChange:!0};0!==histories.current.length&&(undoList.current.push(histories.current.pop()),handleClear({commit:!1,fireOnChange:!1}),histories.current.reduce((function(prev,curr){return[].concat(_toConsumableArray(prev),_toConsumableArray(curr))}),[]).forEach((function(event){"draw"===event.type?handleDraw(event.data,{commit:!1,fireOnChange:!1}):"clear"===event.type&&handleClear({commit:!1,fireOnChange:!1})})),(null==options?void 0:options.fireOnChange)&&(null==onChange||onChange({type:"undo"})))}),[handleDraw,handleClear,onChange]);Object(react.useImperativeHandle)(ref,(function(){return{clearHistories:function clearHistories(){histories.current=[]},draw:handleDraw,clear:handleClear,redo:handleRedo,undo:handleUndo}}));var handlers=Object(react.useMemo)((function(){var drawing=!1,handleDrawStart=function handleDrawStart(e){if(e.preventDefault(),canvasRef.current){var _calculateCoord=calculateCoord(e,canvasRef.current),x=_calculateCoord.x,y=_calculateCoord.y,pressure=enablePressure?calculatePressure(e):1,touchType="touches"in e?e.touches[0].touchType:void 0;handleDraw({command:command,x:x*canvasWidth/width,y:y*canvasHeight/height,width:canvasWidth,height:canvasHeight,lineWidth:lineWidth*width/canvasWidth,scale:scale,color:color,pressure:pressure,state:"draw-started",touchType:touchType}),drawing=!0}},handleDrawing=function handleDrawing(e){if(e.preventDefault(),canvasRef.current&&drawing){var _calculateCoord2=calculateCoord(e,canvasRef.current),x=_calculateCoord2.x,y=_calculateCoord2.y,pressure=enablePressure?calculatePressure(e):1,touchType="touches"in e?e.touches[0].touchType:void 0;handleDraw({command:command,x:x*canvasWidth/width,y:y*canvasHeight/height,width:canvasWidth,height:canvasHeight,lineWidth:lineWidth*width/canvasWidth,scale:scale,color:color,pressure:pressure,state:"drawing",touchType:touchType})}},handleDrawFinish=function handleDrawFinish(e){if(e.preventDefault(),canvasRef.current&&drawing){var _calculateCoord3=calculateCoord(e,canvasRef.current),x=_calculateCoord3.x,y=_calculateCoord3.y;handleDraw({command:command,x:x*canvasWidth/width,y:y*canvasHeight/height,width:canvasWidth,height:canvasHeight,lineWidth:lineWidth*width/canvasWidth,scale:scale,color:color,state:"draw-finished"}),drawing=!1}};return enableDraw?{onMouseDown:handleDrawStart,onTouchStart:handleDrawStart,onMouseMove:handleDrawing,onTouchMove:handleDrawing,onMouseUp:handleDrawFinish,onTouchEnd:handleDrawFinish,onMouseOut:handleDrawFinish}:{}}),[currentPlugins,handleDraw,command,lineWidth,color,width,height,scale,enableDraw]);return Object(jsx_runtime.jsx)("canvas",Object.assign({ref:canvasRef},handlers,{style:Object.assign({},style,canvasDefaultStyle,canvasSizeStyle),className:className}))}));try{Atelier.displayName="Atelier",Atelier.__docgenInfo={description:"",displayName:"Atelier",props:{command:{defaultValue:{value:"pen"},description:"Drawing command",name:"command",required:!1,type:{name:"string"}},color:{defaultValue:{value:"#000000"},description:"Color of the line when drawing.",name:"color",required:!1,type:{name:"string"}},lineWidth:{defaultValue:{value:"2"},description:"Thickness of the line when drawing.",name:"lineWidth",required:!1,type:{name:"number"}},width:{defaultValue:{value:"800"},description:"DOM width",name:"width",required:!1,type:{name:"number"}},height:{defaultValue:{value:"600"},description:"DOM height",name:"height",required:!1,type:{name:"number"}},canvasWidth:{defaultValue:null,description:"Canvas width",name:"canvasWidth",required:!1,type:{name:"number"}},canvasHeight:{defaultValue:null,description:"Canvas height",name:"canvasHeight",required:!1,type:{name:"number"}},enableDraw:{defaultValue:{value:"true"},description:"If you set enableDraw to false, you cannot draw.",name:"enableDraw",required:!1,type:{name:"boolean"}},enablePressure:{defaultValue:{value:"false"},description:"If you set enablePressure to true, pen pressure is applied.",name:"enablePressure",required:!1,type:{name:"boolean"}},plugins:{defaultValue:{value:"[PenPlugin]"},description:"Register the plugin to be used.",name:"plugins",required:!1,type:{name:"(typeof Plugin)[]"}},onChange:{defaultValue:null,description:"Fired when an alteration to canvas is commited.",name:"onChange",required:!1,type:{name:"(e: AtelierChangeEvent) => void"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<AtelierRef>"}},key:{defaultValue:null,description:"",name:"key",required:!1,type:{name:"Key"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/atelier.tsx#Atelier"]={docgenInfo:Atelier.__docgenInfo,name:"Atelier",path:"src/atelier.tsx#Atelier"})}catch(__react_docgen_typescript_loader_error){}function index_stories_toConsumableArray(arr){return function index_stories_arrayWithoutHoles(arr){if(Array.isArray(arr))return index_stories_arrayLikeToArray(arr)}(arr)||function index_stories_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||index_stories_unsupportedIterableToArray(arr)||function index_stories_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function index_stories_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function index_stories_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function index_stories_get(target,property,receiver){return index_stories_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function index_stories_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=index_stories_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}},index_stories_get(target,property,receiver||target)}function index_stories_setPrototypeOf(o,p){return index_stories_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},index_stories_setPrototypeOf(o,p)}function index_stories_createSuper(Derived){var hasNativeReflectConstruct=function index_stories_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=index_stories_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=index_stories_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return index_stories_possibleConstructorReturn(this,result)}}function index_stories_possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function index_stories_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function index_stories_getPrototypeOf(o){return index_stories_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},index_stories_getPrototypeOf(o)}function index_stories_slicedToArray(arr,i){return function index_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function index_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||index_stories_unsupportedIterableToArray(arr,i)||function index_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function index_stories_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return index_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?index_stories_arrayLikeToArray(o,minLen):void 0}}function index_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}__webpack_exports__.default={component:Atelier,title:"Atelier"};var index_stories_Wrapper=function Wrapper(_ref){var children=_ref.children;return Object(jsx_runtime.jsx)("div",{style:{padding:30},children:children})};index_stories_Wrapper.displayName="Wrapper";var index_stories_Default=function Default(){var ref=Object(react.useRef)(),_useState2=index_stories_slicedToArray(Object(react.useState)("pen"),2),command=_useState2[0],setCommand=_useState2[1],_useState4=index_stories_slicedToArray(Object(react.useState)(4),2),lineWidth=_useState4[0],setLineWidth=_useState4[1],_useState6=index_stories_slicedToArray(Object(react.useState)("#000000"),2),color=_useState6[0],setColor=_useState6[1];return Object(jsx_runtime.jsxs)(index_stories_Wrapper,{children:[Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("laser")},children:"Laser"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("pen")},children:"Pen"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("brush")},children:"Brush"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("eraser")},children:"Eraser"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("highlighter")},children:"Highlighter"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return ref.current.clear()},children:"Clear"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return ref.current.undo()},children:"Undo"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return ref.current.redo()},children:"Redo"}),Object(jsx_runtime.jsx)("input",{type:"color",onChange:function onChange(e){return setColor(e.currentTarget.value)}}),Object(jsx_runtime.jsx)("input",{type:"range",onChange:function onChange(e){return setLineWidth(parseInt(e.currentTarget.value))},defaultValue:"4",min:"1",max:"40",step:"1"}),Object(jsx_runtime.jsx)("br",{}),Object(jsx_runtime.jsx)(Atelier,{ref:ref,width:1280,height:720,command:command,lineWidth:lineWidth,color:color,plugins:[PenPlugin,EraserPlugin,LaserPlugin,HighlighterPlugin,BrushPlugin],enablePressure:!0,enableDraw:!0,style:{border:"1px solid black"}})]})};index_stories_Default.displayName="Default";var DashPlugin=function(_Plugin){!function index_stories_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&index_stories_setPrototypeOf(subClass,superClass)}(DashPlugin,_Plugin);var _super=index_stories_createSuper(DashPlugin);function DashPlugin(){var _this;index_stories_classCallCheck(this,DashPlugin);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).name="dash",_this.prevX=void 0,_this.prevY=void 0,_this}return function index_stories_createClass(Constructor,protoProps,staticProps){return protoProps&&index_stories_defineProperties(Constructor.prototype,protoProps),staticProps&&index_stories_defineProperties(Constructor,staticProps),Constructor}(DashPlugin,[{key:"draw",value:function draw(data){var _this$canvas;index_stories_get(index_stories_getPrototypeOf(DashPlugin.prototype),"draw",this).call(this,data);var x=data.x,y=data.y,state=data.state,context=null===(_this$canvas=this.canvas)||void 0===_this$canvas?void 0:_this$canvas.getContext("2d");context.setLineDash([5,30]);var prevX=this.prevX||x,prevY=this.prevY||y;"draw-started"!==state&&"drawing"!==state||(context.beginPath(),context.moveTo(prevX,prevY),context.lineTo(x,y),context.stroke(),context.closePath(),Object.assign(this,{prevX:x,prevY:y}))}}]),DashPlugin}(Plugin),index_stories_CustomPlugin=function CustomPlugin(){var ref=Object(react.useRef)(),_useState8=index_stories_slicedToArray(Object(react.useState)("pen"),2),command=_useState8[0],setCommand=_useState8[1],_useState10=index_stories_slicedToArray(Object(react.useState)(4),2),lineWidth=_useState10[0],setLineWidth=_useState10[1],_useState12=index_stories_slicedToArray(Object(react.useState)("#000000"),2),color=_useState12[0],setColor=_useState12[1];return Object(jsx_runtime.jsxs)(index_stories_Wrapper,{children:[Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("pen")},children:"Pen"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("dash")},children:"Dash"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return ref.current.clear()},children:"Clear"}),Object(jsx_runtime.jsx)("input",{type:"color",onChange:function onChange(e){return setColor(e.currentTarget.value)}}),Object(jsx_runtime.jsx)("input",{type:"range",onChange:function onChange(e){return setLineWidth(parseInt(e.currentTarget.value))},defaultValue:"4",min:"1",max:"40",step:"1"}),Object(jsx_runtime.jsx)("br",{}),Object(jsx_runtime.jsx)(Atelier,{ref:ref,width:1280,height:720,command:command,lineWidth:lineWidth,color:color,plugins:[PenPlugin,DashPlugin],enablePressure:!0,enableDraw:!0,style:{border:"1px solid black"}})]})};index_stories_CustomPlugin.displayName="CustomPlugin";var index_stories_Recording=function Recording(){var ref=Object(react.useRef)(),_useState14=index_stories_slicedToArray(Object(react.useState)(1280),2),width=_useState14[0],setWidth=_useState14[1],_useState16=index_stories_slicedToArray(Object(react.useState)(720),2),height=_useState16[0],setHeight=_useState16[1],_useState18=index_stories_slicedToArray(Object(react.useState)("pen"),2),command=_useState18[0],setCommand=_useState18[1],_useState20=index_stories_slicedToArray(Object(react.useState)(4),2),lineWidth=_useState20[0],setLineWidth=_useState20[1],_useState22=index_stories_slicedToArray(Object(react.useState)("#000000"),2),color=_useState22[0],setColor=_useState22[1],_useState24=index_stories_slicedToArray(Object(react.useState)(!1),2),recording=_useState24[0],setRecording=_useState24[1],_useState26=index_stories_slicedToArray(Object(react.useState)([]),2),recordingList=_useState26[0],setRecordingList=_useState26[1],eventHistories=Object(react.useRef)([]),intervalId=Object(react.useRef)(),handleRecordingStart=Object(react.useCallback)((function(){ref.current.clear({commit:!1,fireOnChange:!1}),eventHistories.current=[],setRecording(!0)}),[]),handleRecordingStop=Object(react.useCallback)((function(){setRecordingList([].concat(index_stories_toConsumableArray(recordingList),[{date:new Date,histories:eventHistories.current}])),eventHistories.current=[],setRecording(!1),ref.current.clear({commit:!1,fireOnChange:!1})}),[recordingList]),handleReplay=Object(react.useCallback)((function(recording){clearInterval(intervalId.current),setRecording(!1),ref.current.clear({commit:!1,fireOnChange:!1}),ref.current.clearHistories();var histories=index_stories_toConsumableArray(recording.histories),begin=Date.now(),startTimestamp=histories[0].timestamp;intervalId.current=setInterval((function(){if(0!==histories.length)for(;histories.length;){var history=histories[0];if(!(Date.now()-begin>=history.timestamp-startTimestamp))break;var event=histories.shift().event;"draw"!==event.type&&console.log(event),"draw"===event.type?ref.current.draw(event.data):"clear"===event.type?ref.current.clear():"redo"===event.type?ref.current.redo():"undo"===event.type&&ref.current.undo()}else clearInterval(intervalId.current)}),10)}),[]);return Object(jsx_runtime.jsxs)(index_stories_Wrapper,{children:[Object(jsx_runtime.jsxs)("div",{children:["Width:",Object(jsx_runtime.jsx)("input",{type:"number",value:width,onChange:function onChange(e){return setWidth(parseInt(e.target.value))}}),"Height:",Object(jsx_runtime.jsx)("input",{type:"number",value:height,onChange:function onChange(e){return setHeight(parseInt(e.target.value))}})]}),Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("laser")},children:"Laser"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("pen")},children:"Pen"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("brush")},children:"Brush"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("eraser")},children:"Eraser"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return setCommand("highlighter")},children:"Highlighter"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return ref.current.clear()},children:"Clear"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return ref.current.undo()},children:"Undo"}),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return ref.current.redo()},children:"Redo"}),Object(jsx_runtime.jsx)("input",{type:"color",onChange:function onChange(e){return setColor(e.currentTarget.value)}}),Object(jsx_runtime.jsx)("input",{type:"range",onChange:function onChange(e){return setLineWidth(parseInt(e.currentTarget.value))},defaultValue:"4",min:"1",max:"40",step:"1"})]}),Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsx)("button",{disabled:recording,onClick:handleRecordingStart,children:"Start recording"}),Object(jsx_runtime.jsx)("button",{disabled:!recording,onClick:handleRecordingStop,children:"Stop recording"})]}),Object(jsx_runtime.jsx)("br",{}),Object(jsx_runtime.jsx)(Atelier,{ref:ref,width:width,height:height,command:command,lineWidth:lineWidth,color:color,plugins:[PenPlugin,EraserPlugin,LaserPlugin,HighlighterPlugin,BrushPlugin],enablePressure:!0,enableDraw:recording,onChange:function onChange(e){return eventHistories.current.push({timestamp:Date.now(),event:e})},style:{border:"1px solid black"}}),Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsx)("h3",{children:"Recording list"}),Object(jsx_runtime.jsx)("ul",{children:recordingList.map((function(item){return Object(jsx_runtime.jsxs)("div",{children:[item.date.toISOString(),Object(jsx_runtime.jsx)("button",{onClick:function onClick(){return handleReplay(item)},children:"Replay"})]},item.date.toISOString())}))})]})]})};index_stories_Recording.displayName="Recording"}},[[317,1,2]]]);